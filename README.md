# ECSI - Error Correction through Signature Integration

Traditional variant calling methods utilize variant allele frequency (VAF) cutoffs to call variants. These cutoffs are often set arbitrarily and the measure becomes problematic when trying to call at variants at low VAFs, where true biological variation becomes hard to distinguish from sequencing error. The 'ECSI' package employs a novel variant calling approach that models sequencing error distributions across 192 trinucleotide  contexts and conducts variant calling by comparing each putative variant to its corresponding contextual error distribution. This demonstrates superior sensitivity and specificity over existing variant calling methods and bolsters our ability to accurately distinguish signal from noise at very low VAFs.



# Installation

Some ECSI dependencies are from bioconductor and not CRAN, so you may need to install these extra packages first:

```
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install(c("BiocGenerics", "BSgenome.Hsapiens.UCSC.hg19", "BSgenome.Hsapiens.UCSC.hg38", "VariantAnnotation", "GenomicScores"))
```

To install ECSI, open R and install directly from github using the following commands: 

```
library(devtools)
install_github("abelson-lab/ECSI")
```

To annotate variants with minor allele frequencies, download the appropriate [MafDB annotation package](https://bioconductor.org/packages/3.8/data/annotation/).

```
# gnomAD exomes release 2.1 - hg19 
BiocManager::install(c("MafDb.gnomADex.r2.1.hs37d5"))

# 1000genomes phase 3 - hg38
BiocManager::install(c("MafDb.1Kgenomes.phase3.GRCh38"))
```



# Workflow

ECSI takes in files generated by VarScan through the pileup2cns command, which generates one pileup file for each sample and includes all positions that met a minimum coverage. This way, ECSI leverages miscalled alleles generated by sequencing error in order to generate context specific error models and call low-VAF variants with more confidence. 

Here is an R notebook outlining the ECSI variant calling workflow:
[ECSI Workflow](http://htmlpreview.github.io/?https://github.com/abelson-lab/ECSI/blob/master/vignettes/ECSI_workflow.nb.html)

